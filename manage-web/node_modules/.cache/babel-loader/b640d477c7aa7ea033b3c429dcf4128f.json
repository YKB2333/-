{"remainingRequest":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\YKB\\Desktop\\github\\manage-web\\src\\view\\account\\millet-detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\src\\view\\account\\millet-detail.vue","mtime":1562898218000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { get, post } from \"../../libs/axios-cfg\";\nexport default {\n  name: \"millet-detail\",\n\n  data() {\n    return {\n      option: {\n        msgTypes: [{\n          id: 'SYS',\n          name: '系统消息'\n        }, {\n          id: 'ACT',\n          name: '活动消息'\n        }],\n        statusTypes: [{\n          id: 'PREPARE',\n          name: '待审核'\n        }, {\n          id: 'SUCCESS',\n          name: '审核成功'\n        }, {\n          id: 'FAIL',\n          name: '审核失败'\n        }]\n      },\n      search: {\n        page: 1,\n        pageSize: 10,\n        phone: null,\n        statusType: null,\n        startTime: null,\n        endTime: null,\n        dateRange: []\n      },\n      content: {\n        loading: false,\n        total: 0,\n        records: [],\n        columns: [{\n          title: '充值ID',\n          key: 'id',\n          width: 100\n        }, {\n          title: '用户名',\n          key: 'username',\n          width: 100\n        }, {\n          title: '手机号',\n          key: 'phone',\n          width: 150\n        }, {\n          title: 'EC币账号',\n          key: 'account',\n          width: 200\n        }, {\n          title: '充值小米',\n          key: 'amount',\n          width: 130\n        }, {\n          title: '审核状态',\n          key: 'status',\n          width: 100,\n          render: (h, params) => {\n            return h('span', {}, params.row.status && params.row.status.name);\n          }\n        }, {\n          title: '充值凭证',\n          key: 'imageUrl',\n          width: 200,\n          render: (h, params) => {\n            if (params.row.imageUrl) {\n              return h('img', {\n                attrs: {\n                  src: this.baseImgUrl + params.row.imageUrl\n                },\n                style: {\n                  width: '150px',\n                  height: '230px'\n                },\n                on: {\n                  click: e => {\n                    this.handleBigImg(e.srcElement.currentSrc);\n                  }\n                }\n              });\n            }\n          }\n        }, {\n          title: '充值时间',\n          key: 'createTime',\n          width: 150\n        }, {\n          title: '操作',\n          key: 'action',\n          width: 150,\n          fixed: 'right',\n          align: 'center',\n          render: (h, params) => {\n            let disabledAudit = false;\n\n            if (params.row.status && params.row.status.value != \"PREPARE\") {\n              disabledAudit = true;\n            }\n\n            return h('div', [h('Button', {\n              props: {\n                type: 'primary',\n                size: 'small',\n                disabled: disabledAudit\n              },\n              style: {\n                marginRight: '5px'\n              },\n              on: {\n                click: () => {\n                  this.handleAudit(params.row);\n                }\n              }\n            }, '审核')]);\n          }\n        }]\n      },\n      form: {\n        title: \"新增系统消息\",\n        show: false,\n        isAdd: true,\n        record: {},\n        ruleValidate: {\n          title: [{\n            required: true,\n            message: '请输入系统消息',\n            trigger: 'blur'\n          }],\n          publishDate: [{\n            required: true,\n            message: '请选择公告日期',\n            trigger: 'change',\n            type: 'date'\n          }],\n          msgType: [{\n            required: true,\n            message: '请选择消息类型',\n            trigger: 'change'\n          }],\n          content: [{\n            required: true,\n            message: '请输入消息内容',\n            trigger: 'blur'\n          }]\n        }\n      },\n      formAudit: {\n        title: \"小米充值审核\",\n        show: false,\n        audit: {\n          id: null,\n          status: null,\n          statusLabel: null\n        }\n      },\n      img: {\n        visible: false,\n        url: ''\n      }\n    };\n  },\n\n  created() {\n    this.queryRecords();\n  },\n\n  methods: {\n    handleBigImg(url) {\n      this.img.url = url;\n      this.img.visible = true;\n    },\n\n    handleSearch() {\n      if (this.search.dateRange && this.search.dateRange.length == 2) {\n        if (this.search.dateRange[0] != \"\") {\n          this.search.startTime = this.search.dateRange[0];\n        } else {\n          this.search.startTime = null;\n        }\n\n        if (this.search.dateRange[1] != \"\") {\n          this.search.endTime = this.search.dateRange[1];\n        } else {\n          this.search.endTime = null;\n        }\n      } else {\n        this.search.startTime = null;\n        this.search.endTime = null;\n      }\n\n      this.queryRecords();\n    },\n\n    handleCreate() {\n      this.form.title = \"新增系统消息\";\n      this.form.isAdd = true;\n      this.form.record = {};\n      this.form.show = true;\n    },\n\n    handleEidt(row) {\n      this.form.title = \"更新系统消息\";\n      this.form.isAdd = false;\n      this.form.record = JSON.parse(JSON.stringify(row));\n\n      if (this.form.record.msgType) {\n        this.form.record.msgType = this.form.record.msgType.value;\n      }\n\n      this.form.show = true;\n    },\n\n    handleAudit(row) {\n      this.formAudit.show = true;\n      this.formAudit.audit.id = row.id;\n    },\n\n    hanldeOkAudit() {\n      if (this.formAudit.audit.statusLabel == \"通过\") {\n        this.formAudit.audit.status = \"SUCCESS\";\n        this.audit(this.formAudit.audit.id, this.formAudit.audit.status);\n        setTimeout(this.queryRecords(), 1000);\n      } else if (this.formAudit.audit.statusLabel == \"不通过\") {\n        this.formAudit.audit.status = \"FAIL\";\n        this.audit(this.formAudit.audit.id, this.formAudit.audit.status);\n        setTimeout(this.queryRecords(), 1000);\n      } else {\n        this.$Message.error(\"请选择审核结果！\");\n      }\n\n      this.formAudit.show = false;\n      this.formAudit.audit = {\n        id: null,\n        status: null,\n        statusLabel: null\n      };\n    },\n\n    handleCancelAudit() {\n      this.formAudit.show = false;\n      this.formAudit.audit = {\n        id: null,\n        status: null,\n        statusLabel: null\n      };\n      this.$Message.info(\"取消审核操作\");\n    },\n\n    handleRemove(row) {\n      this.$Modal.confirm({\n        title: '提醒',\n        content: '<p>确认删除系统消息?</p>',\n        onOk: () => {\n          this.deleteSysMsg(row.id);\n          setTimeout(this.queryRecords, 1000);\n        },\n        onCancel: () => {\n          this.$Message.info('取消删除操作');\n        }\n      });\n    },\n\n    handleChangePage(page) {\n      this.search.page = page;\n      this.queryRecords();\n    },\n\n    handleChangePageSize(pageSize) {\n      this.search.pageSize = pageSize;\n      this.queryRecords();\n    },\n\n    handleSubmit(name) {\n      var self = this;\n      this.$refs[name].validate(valid => {\n        if (valid) {\n          if (self.form.isAdd) {\n            this.createSysMsg();\n          } else {\n            this.updateSysMsg();\n          }\n\n          this.form.show = false;\n          setTimeout(this.queryRecords, 1000);\n        } else {\n          this.$Message.error('验证不通过!');\n        }\n      });\n    },\n\n    handleReset(name) {\n      this.$refs[name].resetFields();\n    },\n\n    async queryRecords() {\n      this.content.loading = true;\n\n      try {\n        let res = await post('api/pomelomgm/millet-detail/list', this.search);\n\n        if (res.status == this.rescode.OK) {\n          this.content.total = res.data.total;\n          this.content.records = res.data.records;\n        } else {\n          this.$Message.error(res.msg);\n        }\n      } catch (e) {\n        this.$throw(e);\n      }\n\n      this.content.loading = false;\n    },\n\n    async createSysMsg() {\n      try {\n        let res = await post(\"api/pomelomgm/sysmsg/add\", this.form.record);\n\n        if (res.status == this.rescode.OK) {\n          this.$Message.success(\"新增成功\");\n        } else {\n          this.$Message.error(res.msg);\n        }\n      } catch (e) {\n        this.$throw(e);\n      }\n    },\n\n    async updateSysMsg() {\n      try {\n        let res = await post(\"api/pomelomgm/sysmsg/update/\" + this.form.record.id, this.form.record);\n\n        if (res.status == this.rescode.OK) {\n          this.$Message.success(\"更新成功\");\n        } else {\n          this.$Message.error(res.msg);\n        }\n      } catch (e) {\n        this.$throw(e);\n      }\n    },\n\n    async deleteSysMsg(id) {\n      try {\n        let res = await post(\"api/pomelomgm/sysmsg/remove/\" + id);\n\n        if (res.status == this.rescode.OK) {\n          this.$Message.success(\"删除成功\");\n        } else {\n          this.$Message.error(res.msg);\n        }\n      } catch (e) {\n        this.$throw(e);\n      }\n    },\n\n    async audit(id, statusType) {\n      try {\n        let res = await get(`api/pomelomgm/millet-detail/audit?id=${id}&statusType=${statusType}`);\n\n        if (res.status == this.rescode.OK) {\n          this.$Message.success(\"审核成功\");\n        } else {\n          this.$Message.error(res.msg);\n        }\n      } catch (e) {\n        this.$throw(e);\n      }\n    }\n\n  }\n};",{"version":3,"sources":["millet-detail.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div>\r\n        <Card>\r\n            <!-- 条件查询 -->\r\n            <div class=\"margin-bottom-10\">\r\n                <Row>\r\n                    <Col span=\"6\">\r\n                        <label>状态: </label>\r\n                        <Select v-model=\"search.statusType\" style=\"width:200px\" placeholder=\"请选择审核状态\" clearable>\r\n                            <Option v-for=\"statusType in option.statusTypes\" :value=\"statusType.id\"\r\n                                    :key=\"statusType.id\">\r\n                                {{statusType.name }}\r\n                            </Option>\r\n                        </Select>\r\n                    </Col>\r\n                    <Col span=\"8\">\r\n                        <label>充值时间: </label>\r\n                        <DatePicker v-model=\"search.dateRange\" type=\"datetimerange\" placement=\"bottom-end\"\r\n                                    placeholder=\"选择充值时间\" style=\"width: 300px\" clearable/>\r\n                    </Col>\r\n                    <Col span=\"6\">\r\n                        <label>用户电话: &nbsp;&nbsp;</label>\r\n                        <Input v-model=\"search.phone\" placeholder=\"请输入用户手机号\" style=\"width: 200px\"/>\r\n                    </Col>\r\n                    <Col span=\"3\">\r\n                        <Button type=\"success\" icon=\"ios-search\" @click=\"handleSearch\">查询</Button>\r\n                    </Col>\r\n                </Row>\r\n            </div>\r\n\r\n            <!-- 数据展示 -->\r\n            <div class=\"chook-cls-list\" style=\"overflow: hidden\">\r\n                <Table border :loading=\"content.loading\" :columns=\"content.columns\" :data=\"content.records\"></Table>\r\n                <div class=\"margin-top-8\"></div>\r\n                <Page :total=\"content.total\" @on-change=\"handleChangePage\" @on-page-size-change=\"handleChangePageSize\"\r\n                      show-sizer show-total show-elevator class=\"margin-right-10\"\r\n                      style=\"display: inline-flex;float: right;\"/>\r\n            </div>\r\n\r\n            <!-- 新增删除 -->\r\n            <Drawer class=\"add-update-drawer\"\r\n                    :title=\"form.title\"\r\n                    v-model=\"form.show\"\r\n                    width=\"720\"\r\n                    :mask-closable=\"false\">\r\n                <Form :model=\"form.record\" ref=\"formRecord\" :rules=\"form.ruleValidate\" style=\"margin-right: 30px\">\r\n                    <FormItem label=\"标题: \" label-position=\"left\" :label-width=\"100\" prop=\"title\">\r\n                        <Input v-model=\"form.record.title\" placeholder=\"请输入消息标题\" style=\"width: 300px\"/>\r\n                    </FormItem>\r\n                    <FormItem label=\"公告日期: \" label-position=\"left\" :label-width=\"100\" prop=\"publishDate\">\r\n                        <DatePicker v-model=\"form.record.publishDate\" type=\"date\" placeholder=\"请选择公告日期\"\r\n                                    style=\"width: 300px\"/>\r\n                    </FormItem>\r\n                    <FormItem label=\"消息类型: \" label-position=\"left\" :label-width=\"100\" prop=\"msgType\">\r\n                        <Select v-model=\"form.record.msgType\" style=\"width:200px\" placeholder=\"请选择集市\" clearable>\r\n                            <Option v-for=\"msgType in option.msgTypes\" :value=\"msgType.id\" :key=\"msgType.id\">\r\n                                {{msgType.name }}\r\n                            </Option>\r\n                        </Select>\r\n                    </FormItem>\r\n                    <FormItem label=\"消息内容: \" label-position=\"left\" :label-width=\"100\" prop=\"content\">\r\n                        <Input v-model=\"form.record.content\" type=\"textarea\" :autosize=\"{minRows: 2,maxRows: 5}\"\r\n                               placeholder=\"请输入消息内容\"/>\r\n                    </FormItem>\r\n                    <FormItem label=\"备注: \" label-position=\"left\" :label-width=\"100\" prop=\"remark\">\r\n                        <Input v-model=\"form.record.remark\" type=\"textarea\" :autosize=\"{minRows: 2,maxRows: 5}\"\r\n                               placeholder=\"请输入备注\"/>\r\n                    </FormItem>\r\n                    <FormItem :label-width=\"80\">\r\n                        <Button type=\"primary\" style=\"margin-left: 30px\" @click=\"handleSubmit('formRecord')\">提交\r\n                        </Button>\r\n                        <Button style=\"margin-left: 8px\" @click=\"handleReset('formRecord')\">重置</Button>\r\n                    </FormItem>\r\n                </Form>\r\n            </Drawer>\r\n\r\n            <!-- 审核操作 -->\r\n            <Modal v-model=\"formAudit.show\"\r\n                   :title=\"formAudit.title\"\r\n                   @on-ok=\"hanldeOkAudit\"\r\n                   @on-cancel=\"handleCancelAudit\">\r\n                <RadioGroup v-model=\"formAudit.audit.statusLabel\" type=\"button\">\r\n                    <Radio label=\"通过\"></Radio>\r\n                    <Radio label=\"不通过\"></Radio>\r\n                </RadioGroup>\r\n            </Modal>\r\n\r\n            <!-- 大图查看 -->\r\n            <Modal title=\"查看大图\" v-model=\"img.visible\" class-name=\"fl-image-modal\">\r\n                <img :src=\"img.url\" v-if=\"img.visible\" style=\"width: 100%\">\r\n            </Modal>\r\n\r\n        </Card>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import {get, post} from \"../../libs/axios-cfg\";\r\n\r\n    export default {\r\n        name: \"millet-detail\",\r\n        data() {\r\n            return {\r\n                option: {\r\n                    msgTypes: [\r\n                        {id: 'SYS', name: '系统消息'},\r\n                        {id: 'ACT', name: '活动消息'},\r\n                    ],\r\n                    statusTypes: [\r\n                        {id: 'PREPARE', name: '待审核'},\r\n                        {id: 'SUCCESS', name: '审核成功'},\r\n                        {id: 'FAIL', name: '审核失败'}\r\n                    ],\r\n\r\n                },\r\n                search: {\r\n                    page: 1,\r\n                    pageSize: 10,\r\n                    phone: null,\r\n                    statusType: null,\r\n                    startTime: null,\r\n                    endTime: null,\r\n                    dateRange: []\r\n                },\r\n                content: {\r\n                    loading: false,\r\n                    total: 0,\r\n                    records: [],\r\n                    columns: [\r\n                        {\r\n                            title: '充值ID',\r\n                            key: 'id',\r\n                            width: 100\r\n                        },\r\n                        {\r\n                            title: '用户名',\r\n                            key: 'username',\r\n                            width: 100\r\n                        },\r\n                        {\r\n                            title: '手机号',\r\n                            key: 'phone',\r\n                            width: 150\r\n                        },\r\n                        {\r\n                            title: 'EC币账号',\r\n                            key: 'account',\r\n                            width: 200\r\n                        },\r\n                        {\r\n                            title: '充值小米',\r\n                            key: 'amount',\r\n                            width: 130\r\n                        },\r\n                        {\r\n                            title: '审核状态',\r\n                            key: 'status',\r\n                            width: 100,\r\n                            render: (h, params) => {\r\n                                return h('span', {}, params.row.status && params.row.status.name);\r\n                            }\r\n                        },\r\n                        {\r\n                            title: '充值凭证',\r\n                            key: 'imageUrl',\r\n                            width: 200,\r\n                            render: (h, params) => {\r\n                                if (params.row.imageUrl) {\r\n                                    return h('img', {\r\n                                        attrs: {\r\n                                            src: this.baseImgUrl + params.row.imageUrl,\r\n                                        },\r\n                                        style: {\r\n                                            width: '150px',\r\n                                            height: '230px'\r\n                                        },\r\n                                        on: {\r\n                                            click: (e) => {\r\n                                                this.handleBigImg(e.srcElement.currentSrc)\r\n                                            }\r\n                                        }\r\n                                    })\r\n                                }\r\n                            }\r\n                        },\r\n                        {\r\n                            title: '充值时间',\r\n                            key: 'createTime',\r\n                            width: 150\r\n                        },\r\n                        {\r\n                            title: '操作',\r\n                            key: 'action',\r\n                            width: 150,\r\n                            fixed: 'right',\r\n                            align: 'center',\r\n                            render: (h, params) => {\r\n                                let disabledAudit = false;\r\n                                if (params.row.status && params.row.status.value != \"PREPARE\") {\r\n                                    disabledAudit = true;\r\n                                }\r\n                                return h('div', [\r\n                                    h('Button', {\r\n                                        props: {\r\n                                            type: 'primary',\r\n                                            size: 'small',\r\n                                            disabled: disabledAudit\r\n                                        },\r\n                                        style: {\r\n                                            marginRight: '5px'\r\n                                        },\r\n                                        on: {\r\n                                            click: () => {\r\n                                                this.handleAudit(params.row)\r\n                                            }\r\n                                        }\r\n                                    }, '审核')\r\n                                ])\r\n                            }\r\n                        }\r\n                    ]\r\n                },\r\n                form: {\r\n                    title: \"新增系统消息\",\r\n                    show: false,\r\n                    isAdd: true,\r\n                    record: {},\r\n                    ruleValidate: {\r\n                        title: [\r\n                            {required: true, message: '请输入系统消息', trigger: 'blur'}\r\n                        ],\r\n                        publishDate: [\r\n                            {required: true, message: '请选择公告日期', trigger: 'change', type: 'date'}\r\n                        ],\r\n                        msgType: [\r\n                            {required: true, message: '请选择消息类型', trigger: 'change'}\r\n                        ],\r\n                        content: [\r\n                            {required: true, message: '请输入消息内容', trigger: 'blur'}\r\n                        ],\r\n                    }\r\n                },\r\n                formAudit: {\r\n                    title: \"小米充值审核\",\r\n                    show: false,\r\n                    audit: {\r\n                        id: null,\r\n                        status: null,\r\n                        statusLabel: null,\r\n                    }\r\n                },\r\n                img: {\r\n                    visible: false,\r\n                    url: ''\r\n                }\r\n            }\r\n        },\r\n        created() {\r\n            this.queryRecords();\r\n        },\r\n        methods: {\r\n            handleBigImg(url) {\r\n                this.img.url = url;\r\n                this.img.visible = true;\r\n            },\r\n            handleSearch() {\r\n                if (this.search.dateRange && this.search.dateRange.length == 2) {\r\n                    if (this.search.dateRange[0] != \"\") {\r\n                        this.search.startTime = this.search.dateRange[0];\r\n                    } else {\r\n                        this.search.startTime = null;\r\n                    }\r\n                    if (this.search.dateRange[1] != \"\") {\r\n                        this.search.endTime = this.search.dateRange[1];\r\n                    } else {\r\n                        this.search.endTime = null;\r\n                    }\r\n                } else {\r\n                    this.search.startTime = null;\r\n                    this.search.endTime = null;\r\n                }\r\n                this.queryRecords();\r\n            },\r\n            handleCreate() {\r\n                this.form.title = \"新增系统消息\";\r\n                this.form.isAdd = true;\r\n                this.form.record = {};\r\n                this.form.show = true;\r\n            },\r\n            handleEidt(row) {\r\n                this.form.title = \"更新系统消息\";\r\n                this.form.isAdd = false;\r\n                this.form.record = JSON.parse(JSON.stringify(row));\r\n                if (this.form.record.msgType) {\r\n                    this.form.record.msgType = this.form.record.msgType.value;\r\n                }\r\n                this.form.show = true;\r\n            },\r\n            handleAudit(row) {\r\n                this.formAudit.show = true;\r\n                this.formAudit.audit.id = row.id;\r\n            },\r\n            hanldeOkAudit() {\r\n                if (this.formAudit.audit.statusLabel == \"通过\") {\r\n                    this.formAudit.audit.status = \"SUCCESS\";\r\n                    this.audit(this.formAudit.audit.id, this.formAudit.audit.status);\r\n                    setTimeout(this.queryRecords(), 1000);\r\n                } else if (this.formAudit.audit.statusLabel == \"不通过\") {\r\n                    this.formAudit.audit.status = \"FAIL\";\r\n                    this.audit(this.formAudit.audit.id, this.formAudit.audit.status);\r\n                    setTimeout(this.queryRecords(), 1000);\r\n                } else {\r\n                    this.$Message.error(\"请选择审核结果！\");\r\n                }\r\n                this.formAudit.show = false;\r\n                this.formAudit.audit = {\r\n                    id: null,\r\n                    status: null,\r\n                    statusLabel: null\r\n                };\r\n            },\r\n            handleCancelAudit() {\r\n                this.formAudit.show = false;\r\n                this.formAudit.audit = {\r\n                    id: null,\r\n                    status: null,\r\n                    statusLabel: null\r\n                };\r\n                this.$Message.info(\"取消审核操作\");\r\n            },\r\n            handleRemove(row) {\r\n                this.$Modal.confirm({\r\n                    title: '提醒',\r\n                    content: '<p>确认删除系统消息?</p>',\r\n                    onOk: () => {\r\n                        this.deleteSysMsg(row.id);\r\n                        setTimeout(this.queryRecords, 1000);\r\n                    },\r\n                    onCancel: () => {\r\n                        this.$Message.info('取消删除操作');\r\n                    }\r\n                });\r\n            },\r\n            handleChangePage(page) {\r\n                this.search.page = page;\r\n                this.queryRecords();\r\n            },\r\n            handleChangePageSize(pageSize) {\r\n                this.search.pageSize = pageSize;\r\n                this.queryRecords();\r\n            },\r\n            handleSubmit(name) {\r\n                var self = this;\r\n                this.$refs[name].validate((valid) => {\r\n                    if (valid) {\r\n                        if (self.form.isAdd) {\r\n                            this.createSysMsg();\r\n                        } else {\r\n                            this.updateSysMsg();\r\n                        }\r\n                        this.form.show = false;\r\n                        setTimeout(this.queryRecords, 1000);\r\n                    } else {\r\n                        this.$Message.error('验证不通过!');\r\n                    }\r\n                })\r\n            },\r\n            handleReset(name) {\r\n                this.$refs[name].resetFields();\r\n            },\r\n            async queryRecords() {\r\n                this.content.loading = true;\r\n                try {\r\n                    let res = await post('api/pomelomgm/millet-detail/list', this.search);\r\n                    if (res.status == this.rescode.OK) {\r\n                        this.content.total = res.data.total;\r\n                        this.content.records = res.data.records;\r\n                    } else {\r\n                        this.$Message.error(res.msg);\r\n                    }\r\n                } catch (e) {\r\n                    this.$throw(e);\r\n                }\r\n                this.content.loading = false;\r\n            },\r\n            async createSysMsg() {\r\n                try {\r\n                    let res = await post(\"api/pomelomgm/sysmsg/add\", this.form.record);\r\n                    if (res.status == this.rescode.OK) {\r\n                        this.$Message.success(\"新增成功\");\r\n                    } else {\r\n                        this.$Message.error(res.msg);\r\n                    }\r\n                } catch (e) {\r\n                    this.$throw(e);\r\n                }\r\n            },\r\n            async updateSysMsg() {\r\n                try {\r\n                    let res = await post(\"api/pomelomgm/sysmsg/update/\" + this.form.record.id, this.form.record);\r\n                    if (res.status == this.rescode.OK) {\r\n                        this.$Message.success(\"更新成功\");\r\n                    } else {\r\n                        this.$Message.error(res.msg);\r\n                    }\r\n                } catch (e) {\r\n                    this.$throw(e);\r\n                }\r\n            },\r\n            async deleteSysMsg(id) {\r\n                try {\r\n                    let res = await post(\"api/pomelomgm/sysmsg/remove/\" + id);\r\n                    if (res.status == this.rescode.OK) {\r\n                        this.$Message.success(\"删除成功\");\r\n                    } else {\r\n                        this.$Message.error(res.msg);\r\n                    }\r\n                } catch (e) {\r\n                    this.$throw(e);\r\n                }\r\n            },\r\n            async audit(id, statusType) {\r\n                try {\r\n                    let res = await get(`api/pomelomgm/millet-detail/audit?id=${id}&statusType=${statusType}`);\r\n                    if (res.status == this.rescode.OK) {\r\n                        this.$Message.success(\"审核成功\");\r\n                    } else {\r\n                        this.$Message.error(res.msg);\r\n                    }\r\n                } catch (e) {\r\n                    this.$throw(e);\r\n                }\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"],"sourceRoot":"src/view/account"}]}