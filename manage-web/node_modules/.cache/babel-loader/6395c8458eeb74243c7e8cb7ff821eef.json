{"remainingRequest":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\YKB\\Desktop\\github\\manage-web\\src\\view\\system\\role\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\src\\view\\system\\role\\index.vue","mtime":1562898218000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport AddRole from './components/add.vue';\nimport UpdateRole from './components/update.vue';\nimport { post } from '@/libs/axios-cfg';\nexport default {\n  data() {\n    return {\n      addRoleModal: false,\n      updateRoleModal: false,\n      updateObject: null,\n      removeModal: false,\n      setting: {\n        loading: true,\n        showBorder: true\n      },\n      search: {\n        type: 'name',\n        value: ''\n      },\n      columns: [{\n        title: 'ID',\n        key: 'id',\n        sortable: true\n      }, {\n        title: '角色名',\n        key: 'name',\n        sortable: true\n      }, {\n        title: '操作',\n        key: 'action',\n        width: 260,\n        align: 'center',\n        render: (h, params) => {\n          return h('div', [h('Button', {\n            props: {\n              type: 'success',\n              size: 'small'\n            },\n            style: {\n              marginRight: '5px'\n            },\n            on: {\n              click: () => {\n                this.showAllResource(params.row);\n              }\n            }\n          }, '查看权限集'), h('Button', {\n            props: {\n              type: 'primary',\n              size: 'small'\n            },\n            style: {\n              marginRight: '5px'\n            },\n            on: {\n              click: () => {\n                this.openAddOrUpModal(params.row);\n              }\n            }\n          }, '修改信息'), h('Button', {\n            props: {\n              type: 'error',\n              size: 'small'\n            },\n            on: {\n              click: () => {\n                this.removeObject = {\n                  obj: params.row,\n                  index: params.index\n                };\n                this.removeModal = true;\n              }\n            }\n          }, '删除')]);\n        }\n      }],\n      data: {},\n      dataFilter: {\n        page: 1,\n        pageSize: 10\n      },\n      removeObject: null,\n      allResource: null\n    };\n  },\n\n  components: {\n    AddRole,\n    UpdateRole\n  },\n\n  created() {\n    this.getData();\n  },\n\n  methods: {\n    pageChange(p) {\n      this.dataFilter.page = p;\n      this.getData();\n    },\n\n    pageSizeChange(p) {\n      this.dataFilter.pageSize = p;\n      this.getData();\n    },\n\n    async getAllResource() {\n      try {\n        let res = await post('/system/resource/list');\n        this.allResource = res.data;\n      } catch (error) {\n        this.$throw(error);\n      }\n    },\n\n    async remove() {\n      this.removeModal = false;\n\n      if (this.removeObject == null) {\n        this.$Message.warning(\"删除对象为空，无法继续执行！\");\n        return false;\n      }\n\n      this.setting.loading = true;\n\n      try {\n        let res = await post('/system/role/remove/{rid}', null, {\n          rid: this.removeObject.obj.id\n        });\n        this.$Message.success(\"删除成功\");\n        this.data.records.splice(this.removeObject.index, 1);\n      } catch (error) {\n        this.$throw(error);\n      }\n\n      this.setting.loading = false;\n    },\n\n    async getData() {\n      this.setting.loading = true;\n\n      try {\n        let res = await post('/system/role/list', {\n          page: this.dataFilter.page,\n          pageSize: this.dataFilter.pageSize\n        });\n        this.data = res.data;\n      } catch (error) {\n        this.$throw(error);\n      }\n\n      this.setting.loading = false;\n    },\n\n    async openAddOrUpModal(obj, type = 'update') {\n      if (this.allResource === null) {\n        await this.getAllResource();\n      }\n\n      if (obj === null) {\n        this.addRoleModal = true;\n      } else if (type === 'update') {\n        this.updateObject = obj;\n        this.updateRoleModal = true;\n      }\n    },\n\n    onAddRoleModalCancel(up = false) {\n      this.addRoleModal = false;\n      if (up) this.getData();\n    },\n\n    onUpdateRoleModalCancel(up = false) {\n      this.updateRoleModal = false;\n      if (up) this.getData();\n    },\n\n    dealPostData(data, ps, h) {\n      if (data != null) {\n        data.forEach(element => {\n          let r = h('Tag', {\n            props: {\n              color: 'green',\n              type: 'dot'\n            }\n          }, element.name);\n          ps.push(r);\n\n          if (element.children != null) {\n            this.dealPostData(element.children, ps, h);\n          }\n        });\n      }\n    },\n\n    showAllResource(row) {\n      let resources = row.resources;\n\n      if (resources != null && typeof resources == \"object\" && resources.length > 0) {\n        this.$Modal.info({\n          title: row.name + ' - 权限集',\n          width: '40%',\n          render: h => {\n            let ps = [];\n            resources.forEach(element => {\n              let r = h('Tag', {\n                props: {\n                  color: element.color == '' ? 'green' : element.color,\n                  type: 'dot'\n                }\n              }, element.name);\n              ps.push(r);\n              this.dealPostData(element.children, ps, h);\n            });\n            return h('div', {\n              style: {\n                padding: '20px 0 10px 0'\n              }\n            }, ps);\n          }\n        });\n      } else {\n        this.$Notice.destroy();\n        this.$Notice.info({\n          title: \"该角色暂无权限信息\",\n          duration: 3\n        });\n      }\n    },\n\n    exportData(type) {\n      if (type === 1) {\n        this.$refs.table.exportCsv({\n          filename: '权限数据-' + new Date().getTime(),\n          columns: this.columns.filter((col, index) => index != 2),\n          data: this.data.records\n        });\n      }\n    }\n\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div>\r\n        <Card>\r\n            <p slot=\"title\" class=\"card-title\">\r\n                <Icon type=\"home\"></Icon>\r\n                <span>角色管理</span>\r\n            </p>\r\n            <div>\r\n                <template>\r\n                    <Row>\r\n                        <Col span=\"15\">\r\n                            <Button type=\"info\" @click=\"openAddOrUpModal(null)\"><Icon type=\"md-add\"></Icon>&nbsp;添加角色</Button>\r\n                            <Button :disabled=\"setting.loading\" type=\"success\" @click=\"getData\"><Icon type=\"md-refresh\"></Icon>&nbsp;刷新数据</Button>\r\n                            <Button type=\"primary\" @click=\"exportData(1)\"><Icon type=\"ios-download-outline\"></Icon>&nbsp;导出表格</Button>\r\n                        </Col>\r\n                        <Col span=\"9\">\r\n                            <Input v-model=\"search.value\" placeholder=\"请输入您想要搜索的内容...\" class=\"margin-bottom-10\">\r\n                                <Button slot=\"append\" icon=\"ios-search\"></Button>\r\n                            </Input>\r\n                        </Col>\r\n                    </Row>\r\n                    <Table  ref=\"table\"  class=\"margin-bottom-10\" :columns=\"columns\"\r\n                        :loading=\"setting.loading\"  :border=\"setting.showBorder\" :data=\"data.records\"></Table>\r\n                     <Page :total=\"data.total\" class=\"tr\" @on-change=\"pageChange\":current.sync=\"data.current\" :page-size=\"data.size\"\r\n                      @on-page-size-change=\"pageSizeChange\" show-elevator show-sizer></Page>\r\n                </template>\r\n            </div>\r\n        </Card>\r\n        <AddRole v-if=\"addRoleModal\" :all-resource=\"allResource\" @cancel=\"onAddRoleModalCancel\"/>\r\n        <UpdateRole v-if=\"updateRoleModal\" :all-resource=\"allResource\" :update-object=\"updateObject\" @cancel=\"onUpdateRoleModalCancel\"/>\r\n        <Modal v-model=\"removeModal\" width=\"360\">\r\n            <p slot=\"header\" style=\"color:#f60;text-align:center\">\r\n                <Icon type=\"information-circled\"></Icon>\r\n                <span>提示</span>\r\n            </p>\r\n            <div style=\"text-align:center\">\r\n                <p>此操作为不可逆操作，是否确认删除？</p>\r\n            </div>\r\n            <div slot=\"footer\">\r\n                <Button type=\"error\" size=\"large\" long :loading=\"setting.loading\" @click=\"remove\">确认删除</Button>\r\n            </div>\r\n        </Modal>\r\n    </div>\r\n</template>\r\n<script>\r\n    import AddRole from './components/add.vue'\r\n    import UpdateRole from './components/update.vue'\r\n    import { post } from '@/libs/axios-cfg'\r\n    export default {\r\n        data () {\r\n            return {\r\n                addRoleModal:false,\r\n                updateRoleModal:false,\r\n                updateObject:null,\r\n                removeModal:false,\r\n                setting:{\r\n                    loading:true,\r\n                    showBorder:true\r\n                },\r\n                search:{\r\n                    type:'name',\r\n                    value:''\r\n                },\r\n                columns: [\r\n                    {title: 'ID', key: 'id',sortable: true},\r\n                    {title: '角色名', key: 'name',sortable: true},\r\n                    {\r\n                        title: '操作',\r\n                        key: 'action',\r\n                        width: 260,\r\n                        align: 'center',\r\n                        render: (h, params) => {\r\n                            return h('div', [\r\n                                h('Button', {\r\n                                    props: {type: 'success',size: 'small'},\r\n                                    style: {marginRight: '5px'},\r\n                                    on:{\r\n                                        click:()=>{\r\n                                            this.showAllResource(params.row)\r\n                                        }\r\n                                    }\r\n                                }, '查看权限集'),\r\n                                h('Button', {\r\n                                    props: {type: 'primary',size: 'small'},\r\n                                    style: {marginRight: '5px'},\r\n                                    on:{\r\n                                        click:()=>{\r\n                                            this.openAddOrUpModal(params.row)\r\n                                        }\r\n                                    }\r\n                                }, '修改信息'),\r\n                                h('Button', {\r\n                                    props: {type: 'error',size: 'small'},\r\n                                    on:{\r\n                                        click:()=>{\r\n                                            this.removeObject = {\r\n                                                obj:params.row,\r\n                                                index:params.index\r\n                                            }\r\n                                            this.removeModal = true;\r\n                                        }\r\n                                    }\r\n                                }, '删除')\r\n                            ]);\r\n                        }\r\n                    }\r\n                ],\r\n                data: {},\r\n                dataFilter:{\r\n                    page:1,\r\n                    pageSize:10\r\n                },\r\n                removeObject:null,\r\n                allResource:null\r\n            }\r\n        },\r\n        components: {\r\n            AddRole,UpdateRole\r\n        },\r\n        created(){\r\n            this.getData();\r\n        },\r\n        methods:{\r\n            pageChange(p){\r\n                this.dataFilter.page = p;\r\n                this.getData();\r\n            },\r\n            pageSizeChange(p){\r\n                this.dataFilter.pageSize = p;\r\n                this.getData();\r\n            },\r\n            async getAllResource(){\r\n                try {\r\n                    let res = await post('/system/resource/list')\r\n                    this.allResource = res.data;\r\n                } catch (error) {\r\n                    this.$throw(error)\r\n                }\r\n            },\r\n            async remove(){\r\n                this.removeModal = false;\r\n                if(this.removeObject==null){\r\n                    this.$Message.warning(\"删除对象为空，无法继续执行！\");\r\n                    return false;\r\n                }\r\n                this.setting.loading = true;\r\n                try {\r\n                    let res = await post('/system/role/remove/{rid}',null,{\r\n                        rid: this.removeObject.obj.id\r\n                    })\r\n                   this.$Message.success(\"删除成功\");\r\n                    this.data.records.splice(this.removeObject.index,1);\r\n                } catch (error) {\r\n                    this.$throw(error)\r\n                }\r\n                this.setting.loading = false;\r\n            },\r\n            async getData(){\r\n                this.setting.loading = true;\r\n                try {\r\n                    let res = await post('/system/role/list',{\r\n                        page:this.dataFilter.page,\r\n                        pageSize:this.dataFilter.pageSize\r\n                    })\r\n                    this.data = res.data;\r\n                } catch (error) {\r\n                    this.$throw(error)\r\n                }\r\n                this.setting.loading = false;\r\n            },\r\n            async openAddOrUpModal(obj,type = 'update'){\r\n                if(this.allResource===null){\r\n                   await this.getAllResource();\r\n                }\r\n                if(obj===null){\r\n                    this.addRoleModal = true;\r\n                }else if(type==='update'){\r\n                    this.updateObject = obj;\r\n                    this.updateRoleModal = true;\r\n                }\r\n            },\r\n            onAddRoleModalCancel(up=false){\r\n                this.addRoleModal = false;\r\n                if(up) this.getData()\r\n            },\r\n            onUpdateRoleModalCancel(up=false){\r\n                this.updateRoleModal = false;\r\n                if(up) this.getData()\r\n            },\r\n            dealPostData(data, ps, h){\r\n                if(data!=null){\r\n                    data.forEach(element => {\r\n                        let r = h('Tag',{\r\n                            props:{\r\n                                color:'green',\r\n                                type:'dot'\r\n                            }\r\n                        },element.name);\r\n                        ps.push(r);\r\n                        if(element.children!=null){\r\n                            this.dealPostData(element.children, ps, h)\r\n                        }\r\n                    });\r\n                }\r\n\r\n            },\r\n            showAllResource(row){\r\n                let resources = row.resources;\r\n                if(resources!=null && typeof(resources)==\"object\" && resources.length > 0){\r\n                    this.$Modal.info({\r\n                        title: row.name+' - 权限集',\r\n                        width:'40%',\r\n                        render: (h)=>{\r\n                            let ps = [];\r\n                            resources.forEach(element => {\r\n                                let r = h('Tag',{\r\n                                    props:{\r\n                                        color:element.color=='' ? 'green' : element.color,\r\n                                        type:'dot',\r\n                                    }\r\n                                },element.name);\r\n                                ps.push(r);\r\n                                this.dealPostData(element.children,ps, h)\r\n                            });\r\n                            return h('div',{\r\n                                style:{padding:'20px 0 10px 0'}\r\n                            },ps);\r\n                        }\r\n                    });\r\n                }else{\r\n                    this.$Notice.destroy()\r\n                    this.$Notice.info({\r\n                        title:\"该角色暂无权限信息\",\r\n                        duration:3\r\n                    })\r\n                }\r\n            },\r\n            exportData(type){\r\n                if (type === 1) {\r\n                    this.$refs.table.exportCsv({\r\n                        filename: '权限数据-'+new Date().getTime(),\r\n                        columns: this.columns.filter((col, index) => index != 2),\r\n                        data: this.data.records\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n</script>\r\n"],"sourceRoot":"src/view/system/role"}]}