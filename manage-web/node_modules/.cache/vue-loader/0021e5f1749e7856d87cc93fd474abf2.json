{"remainingRequest":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\YKB\\Desktop\\github\\manage-web\\src\\view\\system\\user\\components\\add.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\src\\view\\system\\user\\components\\add.vue","mtime":1562898218000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { post } from '@/libs/axios-cfg'\r\nexport default {\r\n  data() {\r\n    const validateConfirmPwd = (rule, value, callback) => {\r\n      if (value === \"\") {\r\n        callback(new Error(\"请再次输入密码\"));\r\n      } else if (value !== this.data.password) {\r\n        callback(new Error(\"两次输入密码不一致!\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    return {\r\n      show: true,\r\n      loading: false,\r\n      data: {\r\n        username: \"\",\r\n        age: 0,\r\n        status: 1,\r\n        password: \"\",\r\n        rePassword: \"\",\r\n        roles: []\r\n      },\r\n      ruls: {\r\n        username: [\r\n            { required: true, message: \"用户名不能为空\" },\r\n            {pattern:/^(\\w){4,16}$/,message:'用户名应为[A-Za-z0-9_]组成的4-16位字符'}\r\n        ],\r\n        password: [\r\n          { required: true, message: \"请填写密码\"},\r\n          {pattern:/^(\\w){6,18}$/,message:'密码应为[A-Za-z0-9_]组成的6-18位字符'}\r\n        ],\r\n        rePassword: [{ validator: validateConfirmPwd }],\r\n        age: [{ required: true, message: \"年龄不能为空\" }],\r\n        status: [{ required: true, message: \"用户状态不能为空\" }],\r\n        roles: [{ required: true, message: \"请至少选择一个角色\" }]\r\n      }\r\n    };\r\n  },\r\n  props: {\r\n    roles: {\r\n      type: Array,\r\n      default: []\r\n    }\r\n  },\r\n  methods: {\r\n    /**\r\n     * @description 关闭Modal\r\n     * @param reload 是否重新加载数据\r\n     */\r\n    cancel(reload = false) {\r\n      this.$emit(\"cancel\", \"add\", reload);\r\n    },\r\n    /**\r\n     * @description 确定按钮单击回调\r\n     */\r\n    ok() {\r\n      this.$refs.modalForm.validate(valid => {\r\n        if (valid) {\r\n            let roles = []\r\n            this.data.roles.forEach(el=>{\r\n                roles.push(this.roles[el]);\r\n            })\r\n            let data = JSON.parse(JSON.stringify(this.data));\r\n            data.roles = roles;\r\n            this.add(data)\r\n        }\r\n      });\r\n    },\r\n    /**\r\n     * @description 添加用户数据请求\r\n     */\r\n    async add(data){\r\n        this.loading = true;\r\n        try {\r\n            let res = await post('/system/user/add',data)\r\n            this.$Message.success(\"用户 \"+data.username+\" 添加成功\");\r\n            this.cancel(true)\r\n        } catch (error) {\r\n            this.$throw(error)\r\n        }\r\n        this.loading = false;\r\n    }\r\n  }\r\n};\r\n",{"version":3,"sources":["add.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"add.vue","sourceRoot":"src/view/system/user/components","sourcesContent":["<template>\r\n  <div>\r\n    <Modal v-model=\"show\" title=\"添加用户\"\r\n            :mask-closable=\"false\" :closable=\"false\">\r\n        <Form ref=\"modalForm\" :model=\"data\" :rules=\"ruls\"\r\n                    :label-width=\"80\">\r\n            <FormItem label=\"用户名\" prop=\"username\">\r\n                <Input v-model.trim=\"data.username\"></Input>\r\n            </FormItem>\r\n            <FormItem label=\"密码\" prop=\"password\">\r\n                <Input type=\"password\" v-model.trim=\"data.password\"></Input>\r\n            </FormItem>\r\n            <FormItem label=\"重复密码\" prop=\"rePassword\">\r\n                <Input type=\"password\" v-model.trim=\"data.rePassword\"></Input>\r\n            </FormItem>\r\n            <FormItem label=\"年龄\" prop=\"age\">\r\n                <InputNumber :min=\"0\" :step=\"1\" v-model.trim=\"data.age\" style=\"width:100%\"/>\r\n            </FormItem>\r\n            <FormItem label=\"状态\" prop=\"status\">\r\n                <Select v-model.trim=\"data.status\" style=\"width:100%\">\r\n                    <Option v-for=\"item in [{label:'正常',value:1},{label:'锁定',value:0}]\"\r\n                        :value=\"item.value\" :key=\"item.value\">{{ item.label }}</Option>\r\n                </Select>\r\n            </FormItem>\r\n            <FormItem label=\"角色组\" prop=\"roles\">\r\n                <CheckboxGroup v-model=\"data.roles\">\r\n                    <Checkbox v-for=\"(item,index) in roles\" :label=\"index\" :key=\"item.id\">{{item.name}}</Checkbox>\r\n                </CheckboxGroup>\r\n            </FormItem>\r\n        </Form>\r\n        <div slot=\"footer\">\r\n            <Button type=\"default\" :disabled=\"loading\" @click=\"cancel(false)\">取消</Button>\r\n            <Button type=\"primary\" :loading=\"loading\" @click=\"ok\">确定</Button>\r\n        </div>\r\n    </Modal>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { post } from '@/libs/axios-cfg'\r\nexport default {\r\n  data() {\r\n    const validateConfirmPwd = (rule, value, callback) => {\r\n      if (value === \"\") {\r\n        callback(new Error(\"请再次输入密码\"));\r\n      } else if (value !== this.data.password) {\r\n        callback(new Error(\"两次输入密码不一致!\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    return {\r\n      show: true,\r\n      loading: false,\r\n      data: {\r\n        username: \"\",\r\n        age: 0,\r\n        status: 1,\r\n        password: \"\",\r\n        rePassword: \"\",\r\n        roles: []\r\n      },\r\n      ruls: {\r\n        username: [\r\n            { required: true, message: \"用户名不能为空\" },\r\n            {pattern:/^(\\w){4,16}$/,message:'用户名应为[A-Za-z0-9_]组成的4-16位字符'}\r\n        ],\r\n        password: [\r\n          { required: true, message: \"请填写密码\"},\r\n          {pattern:/^(\\w){6,18}$/,message:'密码应为[A-Za-z0-9_]组成的6-18位字符'}\r\n        ],\r\n        rePassword: [{ validator: validateConfirmPwd }],\r\n        age: [{ required: true, message: \"年龄不能为空\" }],\r\n        status: [{ required: true, message: \"用户状态不能为空\" }],\r\n        roles: [{ required: true, message: \"请至少选择一个角色\" }]\r\n      }\r\n    };\r\n  },\r\n  props: {\r\n    roles: {\r\n      type: Array,\r\n      default: []\r\n    }\r\n  },\r\n  methods: {\r\n    /**\r\n     * @description 关闭Modal\r\n     * @param reload 是否重新加载数据\r\n     */\r\n    cancel(reload = false) {\r\n      this.$emit(\"cancel\", \"add\", reload);\r\n    },\r\n    /**\r\n     * @description 确定按钮单击回调\r\n     */\r\n    ok() {\r\n      this.$refs.modalForm.validate(valid => {\r\n        if (valid) {\r\n            let roles = []\r\n            this.data.roles.forEach(el=>{\r\n                roles.push(this.roles[el]);\r\n            })\r\n            let data = JSON.parse(JSON.stringify(this.data));\r\n            data.roles = roles;\r\n            this.add(data)\r\n        }\r\n      });\r\n    },\r\n    /**\r\n     * @description 添加用户数据请求\r\n     */\r\n    async add(data){\r\n        this.loading = true;\r\n        try {\r\n            let res = await post('/system/user/add',data)\r\n            this.$Message.success(\"用户 \"+data.username+\" 添加成功\");\r\n            this.cancel(true)\r\n        } catch (error) {\r\n            this.$throw(error)\r\n        }\r\n        this.loading = false;\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n"]}]}