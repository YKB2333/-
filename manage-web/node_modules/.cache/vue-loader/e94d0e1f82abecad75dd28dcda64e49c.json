{"remainingRequest":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\YKB\\Desktop\\github\\manage-web\\src\\view\\trade\\trade-list-show.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\src\\view\\trade\\trade-list-show.vue","mtime":1562898218000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {get, post} from \"../../libs/axios-cfg\";\nimport bus from \"../../bus.js\";\n\nexport default {\n    name: \"trade-list-show\",\n    props: {\n        type: {\n            type: String,\n            default: \"\"\n        },\n    },\n    created() {\n        let self = this;\n        if (this.type == \"WAIT_PAY\") {\n            this.queryOrder();\n        }\n        bus.$on(\"clickTradeListTab\", function (type) {\n            if (self.type == type) {\n                self.queryOrder();\n            }\n        });\n    },\n    destroyed() {\n        bus.$off(\"clickTradeListTab\");\n    },\n    data() {\n        return {\n            search: {\n                buyUserName: null,\n                buyUserPhone: null,\n                sellUserName: null,\n                sellUserPhone: null,\n                orderStatus: this.type,\n                startDate: null,\n                endDate: null,\n                dataRange: [],\n                page: 1,\n                pageSize: 10\n            },\n            content: {\n                loading: false,\n                total: 0,\n                records: [],\n                columns: [\n                    {\n                        title: '区块编号',\n                        key: 'blockNo'\n                    },\n                    {\n                        title: '买家ID',\n                        key: 'buyUserId',\n                        width: 100,\n                    },\n                    {\n                        title: '买家名称',\n                        key: 'buyUserName'\n                    },\n                    {\n                        title: '卖家ID',\n                        key: 'sellUserId',\n                        width: 100,\n                    },\n                    {\n                        title: '卖家名称',\n                        key: 'sellUserName'\n                    },\n                    {\n                        title: '柚子鸡ID',\n                        key: 'chookId',\n                        width: 100,\n                    },\n                    {\n                        title: '柚子鸡',\n                        key: 'chookName'\n                    },\n                    {\n                        title: '价值',\n                        key: 'chookValue'\n                    },\n                    {\n                        title: '交易时间',\n                        key: 'createTime',\n                        width: 150,\n                    },\n                    {\n                        title: '操作',\n                        key: 'action',\n                        width: this.type == \"APPEAL\" ? 250 : 150,\n                        fixed: 'right',\n                        align: 'center',\n                        render: (h, params) => {\n                            let actionList = [\n                                h('Button', {\n                                    props: {\n                                        type: 'primary',\n                                        size: 'small'\n                                    },\n                                    style: {\n                                        marginRight: '5px'\n                                    },\n                                    on: {\n                                        click: () => {\n                                            this.handleShowDetail(params.row)\n                                        }\n                                    }\n                                }, '查看详情')\n                            ];\n                            if (this.type == \"APPEAL\") {\n                                actionList.push(h('Button', {\n                                    props: {\n                                        type: 'info',\n                                        size: 'small'\n                                    },\n                                    style: {\n                                        marginRight: '5px'\n                                    },\n                                    on: {\n                                        click: () => {\n                                            this.handleAuditPass(params.row)\n                                        }\n                                    }\n                                }, '通过'));\n                                actionList.push(h('Button', {\n                                    props: {\n                                        type: 'warning',\n                                        size: 'small'\n                                    },\n                                    style: {\n                                        marginRight: '5px'\n                                    },\n                                    on: {\n                                        click: () => {\n                                            this.handleAuditNoPass(params.row)\n                                        }\n                                    }\n                                }, '不通过'))\n                            }\n                            return h('div', actionList);\n                        }\n                    }\n                ]\n            },\n            view: {\n                show: false,\n                order: {\n                    blockNo: null\n                }\n            }\n        }\n    },\n    methods: {\n        handleSearch() {\n            this.queryOrder();\n        },\n        handleChangePage(page) {\n            this.search.page = page;\n            this.queryOrder();\n        },\n        handleChangePageSize(pageSize) {\n            this.search.pageSize = pageSize;\n            this.queryOrder();\n        },\n        handleShowDetail(row) {\n            this.view.order = row;\n            if (this.view.order.buyVoucher) {\n                this.view.order.buyVoucher = this.baseImgUrl + this.view.order.buyVoucher;\n            }\n            if (this.view.order.sellVoucher) {\n                this.view.order.sellVoucher = this.baseImgUrl + this.view.order.sellVoucher;\n            }\n            this.view.show = true;\n        },\n        handleAuditPass(row) {\n            this.$Modal.confirm({\n                title: '申诉审核通过',\n                content: '<p>该操作不可逆转,确认通过该申诉?</p>',\n                onOk: () => {\n                    this.appealAudit(row.id, 'Y');\n                },\n                onCancel: () => {\n                    this.$Message.info('取消申诉审核');\n                }\n            });\n        },\n        handleAuditNoPass(row) {\n            this.$Modal.confirm({\n                title: '申诉审核不通过',\n                content: '<p>该操作不可逆转,确认不通过该申诉?</p>',\n                onOk: () => {\n                    this.appealAudit(row.id, 'N');\n                },\n                onCancel: () => {\n                    this.$Message.info('取消申诉审核');\n                }\n            });\n        },\n        async queryOrder() {\n            if (this.search.dataRange && this.search.dataRange.length == 2) {\n                this.search.startDate = this.search.dataRange[0] && this.search.dataRange[0].format(\"yyyy-MM-dd hh:mm:ss\");\n                this.search.endDate = this.search.dataRange[1] && this.search.dataRange[1].format(\"yyyy-MM-dd hh:mm:ss\");\n            }\n            this.content.loading = true;\n            try {\n                let res = await post(\"api/pomelomgm/order/list\", this.search);\n                if (res.status == this.rescode.OK) {\n                    this.content.total = res.data.total;\n                    this.content.records = res.data.records;\n                } else {\n                    this.$Message.error(res.msg);\n                }\n            } catch (e) {\n                this.$throw(e);\n            }\n            this.content.loading = false;\n        },\n        async appealAudit(orderId, status) {\n            try {\n                let res = await get(\"api/pomelomgm/order/appeal/audit?orderId=\" + orderId + \"&status=\" + status);\n                if (res.status == this.rescode.OK) {\n                    this.$Message.success(\"审核操作成功\");\n                } else {\n                    this.$Message.error(res.msg);\n                }\n                this.queryOrder();\n            } catch (e) {\n                this.$throw(e);\n            }\n        }\n    }\n}\n",{"version":3,"sources":["trade-list-show.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8DA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"trade-list-show.vue","sourceRoot":"src/view/trade","sourcesContent":["<template>\r\n    <div>\r\n        <!-- 数据查询 -->\r\n        <div class=\"margin-bottom-10\">\r\n            <Row class=\"margin-bottom-10\">\r\n                <Col span=\"6\">\r\n                    <label>买家名称: &nbsp;&nbsp;</label>\r\n                    <Input v-model=\"search.buyUserName\" placeholder=\"请输入买家名称\" style=\"width: 200px\"/>\r\n                </Col>\r\n                <Col span=\"6\">\r\n                    <label>卖家名称: &nbsp;&nbsp;</label>\r\n                    <Input v-model=\"search.sellUserName\" placeholder=\"请输入卖家名称\" style=\"width: 200px\"/>\r\n                </Col>\r\n                <Col span=\"6\">\r\n                    <label>订单时间: &nbsp;&nbsp;</label>\r\n                    <DatePicker v-model=\"search.dataRange\" format=\"yyyy-MM-dd\" type=\"daterange\" placement=\"bottom-end\"\r\n                                placeholder=\"请输入时间范围\" style=\"width: 200px\"></DatePicker>\r\n                </Col>\r\n            </Row>\r\n            <Row>\r\n                <Col span=\"6\">\r\n                    <label>买家电话: &nbsp;&nbsp;</label>\r\n                    <Input v-model=\"search.buyUserPhone\" placeholder=\"请输入买家电话\" style=\"width: 200px\"/>\r\n                </Col>\r\n                <Col span=\"6\">\r\n                    <label>卖家电话: &nbsp;&nbsp;</label>\r\n                    <Input v-model=\"search.sellUserPhone\" placeholder=\"请输入卖家电话\" style=\"width: 200px\"/>\r\n                </Col>\r\n                <Col span=\"6\">\r\n                    <Button type=\"success\" icon=\"ios-search\" @click=\"handleSearch\">查询</Button>\r\n                </Col>\r\n            </Row>\r\n        </div>\r\n\r\n        <!-- 数据展示 -->\r\n        <div class=\"chook-cls-list\" style=\"overflow: hidden\">\r\n            <Table border :loading=\"content.loading\" :columns=\"content.columns\" :data=\"content.records\"></Table>\r\n            <div class=\"margin-top-8\"></div>\r\n            <Page :total=\"content.total\" @on-change=\"handleChangePage\" @on-page-size-change=\"handleChangePageSize\"\r\n                  show-sizer show-total show-elevator class=\"margin-right-10\"\r\n                  style=\"display: inline-flex;float: right;\"/>\r\n        </div>\r\n\r\n        <!-- 查看详情 -->\r\n        <Modal\r\n                v-model=\"view.show\"\r\n                title=\"交易详情\">\r\n            <p>区块编号: {{view.order.blockNo}}</p>\r\n            <p>买方名称: {{view.order.buyUserName}}</p>\r\n            <p>卖方名称: {{view.order.sellUserName}}</p>\r\n            <p>买方凭证:\r\n                <img :src=\"view.order.buyVoucher\" width=\"150\" height=\"200\">\r\n            </p>\r\n            <p>卖方凭证:\r\n                <img :src=\"view.order.sellVoucher\" width=\"150\" height=\"200\">\r\n            </p>\r\n        </Modal>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import {get, post} from \"../../libs/axios-cfg\";\r\n    import bus from \"../../bus.js\";\r\n\r\n    export default {\r\n        name: \"trade-list-show\",\r\n        props: {\r\n            type: {\r\n                type: String,\r\n                default: \"\"\r\n            },\r\n        },\r\n        created() {\r\n            let self = this;\r\n            if (this.type == \"WAIT_PAY\") {\r\n                this.queryOrder();\r\n            }\r\n            bus.$on(\"clickTradeListTab\", function (type) {\r\n                if (self.type == type) {\r\n                    self.queryOrder();\r\n                }\r\n            });\r\n        },\r\n        destroyed() {\r\n            bus.$off(\"clickTradeListTab\");\r\n        },\r\n        data() {\r\n            return {\r\n                search: {\r\n                    buyUserName: null,\r\n                    buyUserPhone: null,\r\n                    sellUserName: null,\r\n                    sellUserPhone: null,\r\n                    orderStatus: this.type,\r\n                    startDate: null,\r\n                    endDate: null,\r\n                    dataRange: [],\r\n                    page: 1,\r\n                    pageSize: 10\r\n                },\r\n                content: {\r\n                    loading: false,\r\n                    total: 0,\r\n                    records: [],\r\n                    columns: [\r\n                        {\r\n                            title: '区块编号',\r\n                            key: 'blockNo'\r\n                        },\r\n                        {\r\n                            title: '买家ID',\r\n                            key: 'buyUserId',\r\n                            width: 100,\r\n                        },\r\n                        {\r\n                            title: '买家名称',\r\n                            key: 'buyUserName'\r\n                        },\r\n                        {\r\n                            title: '卖家ID',\r\n                            key: 'sellUserId',\r\n                            width: 100,\r\n                        },\r\n                        {\r\n                            title: '卖家名称',\r\n                            key: 'sellUserName'\r\n                        },\r\n                        {\r\n                            title: '柚子鸡ID',\r\n                            key: 'chookId',\r\n                            width: 100,\r\n                        },\r\n                        {\r\n                            title: '柚子鸡',\r\n                            key: 'chookName'\r\n                        },\r\n                        {\r\n                            title: '价值',\r\n                            key: 'chookValue'\r\n                        },\r\n                        {\r\n                            title: '交易时间',\r\n                            key: 'createTime',\r\n                            width: 150,\r\n                        },\r\n                        {\r\n                            title: '操作',\r\n                            key: 'action',\r\n                            width: this.type == \"APPEAL\" ? 250 : 150,\r\n                            fixed: 'right',\r\n                            align: 'center',\r\n                            render: (h, params) => {\r\n                                let actionList = [\r\n                                    h('Button', {\r\n                                        props: {\r\n                                            type: 'primary',\r\n                                            size: 'small'\r\n                                        },\r\n                                        style: {\r\n                                            marginRight: '5px'\r\n                                        },\r\n                                        on: {\r\n                                            click: () => {\r\n                                                this.handleShowDetail(params.row)\r\n                                            }\r\n                                        }\r\n                                    }, '查看详情')\r\n                                ];\r\n                                if (this.type == \"APPEAL\") {\r\n                                    actionList.push(h('Button', {\r\n                                        props: {\r\n                                            type: 'info',\r\n                                            size: 'small'\r\n                                        },\r\n                                        style: {\r\n                                            marginRight: '5px'\r\n                                        },\r\n                                        on: {\r\n                                            click: () => {\r\n                                                this.handleAuditPass(params.row)\r\n                                            }\r\n                                        }\r\n                                    }, '通过'));\r\n                                    actionList.push(h('Button', {\r\n                                        props: {\r\n                                            type: 'warning',\r\n                                            size: 'small'\r\n                                        },\r\n                                        style: {\r\n                                            marginRight: '5px'\r\n                                        },\r\n                                        on: {\r\n                                            click: () => {\r\n                                                this.handleAuditNoPass(params.row)\r\n                                            }\r\n                                        }\r\n                                    }, '不通过'))\r\n                                }\r\n                                return h('div', actionList);\r\n                            }\r\n                        }\r\n                    ]\r\n                },\r\n                view: {\r\n                    show: false,\r\n                    order: {\r\n                        blockNo: null\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        methods: {\r\n            handleSearch() {\r\n                this.queryOrder();\r\n            },\r\n            handleChangePage(page) {\r\n                this.search.page = page;\r\n                this.queryOrder();\r\n            },\r\n            handleChangePageSize(pageSize) {\r\n                this.search.pageSize = pageSize;\r\n                this.queryOrder();\r\n            },\r\n            handleShowDetail(row) {\r\n                this.view.order = row;\r\n                if (this.view.order.buyVoucher) {\r\n                    this.view.order.buyVoucher = this.baseImgUrl + this.view.order.buyVoucher;\r\n                }\r\n                if (this.view.order.sellVoucher) {\r\n                    this.view.order.sellVoucher = this.baseImgUrl + this.view.order.sellVoucher;\r\n                }\r\n                this.view.show = true;\r\n            },\r\n            handleAuditPass(row) {\r\n                this.$Modal.confirm({\r\n                    title: '申诉审核通过',\r\n                    content: '<p>该操作不可逆转,确认通过该申诉?</p>',\r\n                    onOk: () => {\r\n                        this.appealAudit(row.id, 'Y');\r\n                    },\r\n                    onCancel: () => {\r\n                        this.$Message.info('取消申诉审核');\r\n                    }\r\n                });\r\n            },\r\n            handleAuditNoPass(row) {\r\n                this.$Modal.confirm({\r\n                    title: '申诉审核不通过',\r\n                    content: '<p>该操作不可逆转,确认不通过该申诉?</p>',\r\n                    onOk: () => {\r\n                        this.appealAudit(row.id, 'N');\r\n                    },\r\n                    onCancel: () => {\r\n                        this.$Message.info('取消申诉审核');\r\n                    }\r\n                });\r\n            },\r\n            async queryOrder() {\r\n                if (this.search.dataRange && this.search.dataRange.length == 2) {\r\n                    this.search.startDate = this.search.dataRange[0] && this.search.dataRange[0].format(\"yyyy-MM-dd hh:mm:ss\");\r\n                    this.search.endDate = this.search.dataRange[1] && this.search.dataRange[1].format(\"yyyy-MM-dd hh:mm:ss\");\r\n                }\r\n                this.content.loading = true;\r\n                try {\r\n                    let res = await post(\"api/pomelomgm/order/list\", this.search);\r\n                    if (res.status == this.rescode.OK) {\r\n                        this.content.total = res.data.total;\r\n                        this.content.records = res.data.records;\r\n                    } else {\r\n                        this.$Message.error(res.msg);\r\n                    }\r\n                } catch (e) {\r\n                    this.$throw(e);\r\n                }\r\n                this.content.loading = false;\r\n            },\r\n            async appealAudit(orderId, status) {\r\n                try {\r\n                    let res = await get(\"api/pomelomgm/order/appeal/audit?orderId=\" + orderId + \"&status=\" + status);\r\n                    if (res.status == this.rescode.OK) {\r\n                        this.$Message.success(\"审核操作成功\");\r\n                    } else {\r\n                        this.$Message.error(res.msg);\r\n                    }\r\n                    this.queryOrder();\r\n                } catch (e) {\r\n                    this.$throw(e);\r\n                }\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"]}]}