{"remainingRequest":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\YKB\\Desktop\\github\\manage-web\\src\\view\\system\\config\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\src\\view\\system\\config\\index.vue","mtime":1562898218000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\YKB\\Desktop\\github\\manage-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {post} from \"../../../libs/axios-cfg\";\n\nexport default {\n    name: \"index\",\n    data() {\n        return {\n            options: {\n                status: [\n                    {value: \"Y\", label: \"生效\"},\n                    {value: \"N\", label: \"失效\"}\n                ],\n                configCls: [\n                    {value: \"CONSTANTS\", label: \"系统常量配置\"},\n                    {value: \"MILLET_COMMON\", label: \"小米充值配置普通\"},\n                    {value: \"MILLET_PRIMARY\", label: \"小米充值配置会员\"},\n                    {value: \"MILLET_SENIOR\", label: \"小米充值配置高级\"},\n                    {value: \"MILLET_SUPERSTAR\", label: \"小米充值配置超级\"},\n                    {value: \"COUNTRY_LIST\", label: \"国家配置\"}\n                ]\n            },\n            search: {\n                status: null,\n                configCls: null,\n                variable: null,\n                page: 1,\n                pageSize: 10\n            },\n            content: {\n                loading: false,\n                total: 0,\n                records: [],\n                columns: [\n                    {\n                        title: '配置ID',\n                        key: 'id',\n                        width: 100\n                    },\n                    {\n                        title: '配置参数',\n                        key: 'variable',\n                        width: 250\n                    },\n                    {\n                        title: '配置值',\n                        key: 'value',\n                        width: 500\n                    },\n                    {\n                        title: '配置分类',\n                        key: 'configCls',\n                        width: 150,\n                        render: (h, params) => {\n                            return h('span', {}, params.row.configCls && params.row.configCls.name);\n                        }\n                    },\n                    {\n                        title: '扩展值',\n                        key: 'extendValue',\n                        width: 200\n                    },\n                    {\n                        title: '是否生效',\n                        key: 'status',\n                        width: 100,\n                        render: (h, params) => {\n                            return h('span', {}, params.row.status && params.row.status.name);\n                        }\n                    },\n                    {\n                        title: '备注',\n                        key: 'remark',\n                        width: 200\n                    },\n                    {\n                        title: '操作',\n                        key: 'action',\n                        width: 150,\n                        fixed: 'right',\n                        align: 'center',\n                        render: (h, params) => {\n                            return h('div', [\n                                h('Button', {\n                                    props: {\n                                        type: 'primary',\n                                        size: 'small'\n                                    },\n                                    style: {\n                                        marginRight: '5px'\n                                    },\n                                    on: {\n                                        click: () => {\n                                            this.handleEdit(params.row)\n                                        }\n                                    }\n                                }, '编辑')\n                            ])\n                        }\n                    }\n                ]\n            },\n            form: {\n                title: \"新增配置项\",\n                isAdd: true,\n                show: false,\n                config: {},\n                ruleValidate: {\n                    variable: [\n                        {required: true, message: '配置参数不能为空', trigger: 'blur'}\n                    ],\n                    value: [\n                        {required: true, message: '配置值不能为空', trigger: 'blur'}\n                    ],\n                    status: [\n                        {required: true, message: '状态不能为空', trigger: 'change'}\n                    ]\n                }\n            }\n        }\n    },\n    created() {\n        this.queryConfig();\n    },\n    methods: {\n        handleSearch() {\n            this.queryConfig();\n        },\n        handleEdit(row) {\n            this.form.title = \"修改配置项\";\n            this.form.isAdd = false;\n            this.form.config = JSON.parse(JSON.stringify(row));\n            if (this.form.config.status) {\n                this.form.config.status = this.form.config.status.value;\n            }\n            if (this.form.config.configCls) {\n                this.form.config.configCls = this.form.config.configCls.value;\n            }\n            this.form.show = true;\n        },\n        handleCreate() {\n            this.form.title = \"新增配置项\";\n            this.form.isAdd = true;\n            this.form.config = {};\n            this.form.show = true;\n        },\n        handleChangePage(page) {\n            this.search.page = page;\n            this.queryConfig();\n        },\n        handleChangePageSize(pageSize) {\n            this.search.pageSize = pageSize;\n            this.queryConfig();\n        },\n        handleSubmit(name) {\n            var self = this;\n            this.$refs[name].validate((valid) => {\n                if (valid) {\n                    if (self.form.isAdd) {\n                        this.createConfig();\n                    } else {\n                        this.updateConfig();\n                    }\n                    this.form.show = false;\n                    setTimeout(this.queryConfig, 1000);\n                } else {\n                    this.$Message.error('验证不通过!')\n                }\n            })\n        },\n        handleReset(name) {\n            this.$refs[name].resetFields();\n        },\n        async queryConfig() {\n            this.content.loading = true;\n            try {\n                let res = await post(\"/system/config/list\", this.search);\n                if (res.status == this.rescode.OK) {\n                    this.content.records = res.data.records;\n                    this.content.total = res.data.total;\n                } else {\n                    this.$Message.error(res.msg);\n                }\n            } catch (e) {\n                this.$throw(e);\n            }\n            this.content.loading = false;\n        },\n        async createConfig() {\n            try {\n                let res = await post(\"/system/config/add\", this.form.config);\n                if (res.status = this.rescode.OK) {\n                    this.$Message.success(\"新增成功\");\n                } else {\n                    this.$Message.error(res.msg);\n                }\n            } catch (e) {\n                this.$throw(e);\n            }\n        },\n        async updateConfig() {\n            try {\n                let res = await post(\"/system/config/update/\" + this.form.config.id, this.form.config);\n                if (res.status = this.rescode.OK) {\n                    this.$Message.success(\"更新成功\");\n                } else {\n                    this.$Message.error(res.msg);\n                }\n            } catch (e) {\n                this.$throw(e);\n            }\n        }\n    }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsFA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/view/system/config","sourcesContent":["<template>\r\n    <div>\r\n        <Card>\r\n            <!-- 条件查询 -->\r\n            <div class=\"margin-bottom-10\">\r\n                <Row>\r\n                    <Col span=\"6\">\r\n                        <label>状态: &nbsp;&nbsp;</label>\r\n                        <Select v-model=\"search.status\" placeholder=\"请选择状态\" style=\"width: 180px\" clearable>\r\n                            <Option v-for=\"status in options.status\" :value=\"status.value\" :key=\"status.value\">\r\n                                {{status.label }}\r\n                            </Option>\r\n                        </Select>\r\n                    </Col>\r\n                    <Col span=\"6\">\r\n                        <label>配置分类: &nbsp;&nbsp;</label>\r\n                        <Select v-model=\"search.configCls\" placeholder=\"请选择配置分类\" style=\"width: 180px\" clearable>\r\n                            <Option v-for=\"status in options.configCls\" :value=\"status.value\" :key=\"status.value\">\r\n                                {{status.label }}\r\n                            </Option>\r\n                        </Select>\r\n                    </Col>\r\n                    <Col span=\"6\">\r\n                        <label>配置参数: &nbsp;&nbsp;</label>\r\n                        <Input v-model=\"search.variable\" placeholder=\"请输入配置参数\" style=\"width: 180px\"/>\r\n                    </Col>\r\n                    <Col span=\"6\">\r\n                        <Button type=\"success\" icon=\"ios-search\" @click=\"handleSearch\">查询</Button>\r\n                        <Button type=\"info\" icon=\"md-add\" @click=\"handleCreate\">新增</Button>\r\n                    </Col>\r\n                </Row>\r\n            </div>\r\n\r\n            <!-- 数据展示 -->\r\n            <div style=\"overflow: hidden\">\r\n                <Table border :loading=\"content.loading\" :columns=\"content.columns\" :data=\"content.records\"></Table>\r\n                <div class=\"margin-top-8\"></div>\r\n                <Page :total=\"content.total\" @on-change=\"handleChangePage\" @on-page-size-change=\"handleChangePageSize\"\r\n                      show-sizer show-total show-elevator class=\"margin-right-10\"\r\n                      style=\"display: inline-flex;float: right;\"/>\r\n            </div>\r\n\r\n            <!-- 新增修改 -->\r\n            <Drawer class=\"add-update-drawer\" :title=\"form.title\"\r\n                    v-model=\"form.show\"\r\n                    width=\"720\"\r\n                    :mask-closable=\"false\">\r\n                <Form :model=\"form.config\" ref=\"formConfig\" :rules=\"form.ruleValidate\" style=\"margin-right: 30px\">\r\n                    <FormItem label=\"配置参数: \" label-position=\"left\" :label-width=\"80\" prop=\"variable\">\r\n                        <Input v-model=\"form.config.variable\" style=\"width: 300px\" :disabled=\"!form.isAdd\"/>\r\n                    </FormItem>\r\n                    <FormItem label=\"配置值: \" label-position=\"left\" :label-width=\"80\" prop=\"value\">\r\n                        <Input v-model=\"form.config.value\" type=\"textarea\" :autosize=\"{minRows: 2,maxRows: 5}\"/>\r\n                    </FormItem>\r\n                    <FormItem label=\"扩展配置值: \" label-position=\"left\" :label-width=\"80\" prop=\"extendValue\">\r\n                        <Input v-model=\"form.config.extendValue\" type=\"textarea\" :autosize=\"{minRows: 2,maxRows: 5}\"/>\r\n                    </FormItem>\r\n                    <FormItem label=\"配置分类: \" label-position=\"left\" :label-width=\"80\" prop=\"configCls\">\r\n                        <Select v-model=\"form.config.configCls\" placeholder=\"请选择配置分类\" style=\"width: 180px\" clearable>\r\n                            <Option v-for=\"status in options.configCls\" :value=\"status.value\" :key=\"status.value\">\r\n                                {{status.label }}\r\n                            </Option>\r\n                        </Select>\r\n                    </FormItem>\r\n                    <FormItem label=\"状态: \" label-position=\"left\" :label-width=\"80\" prop=\"status\">\r\n                        <Select v-model=\"form.config.status\" placeholder=\"请输入状态\" style=\"width: 180px\" clearable>\r\n                            <Option v-for=\"status in options.status\" :value=\"status.value\" :key=\"status.value\">\r\n                                {{status.label }}\r\n                            </Option>\r\n                        </Select>\r\n                    </FormItem>\r\n                    <FormItem label=\"备注: \" label-position=\"left\" :label-width=\"80\" prop=\"remark\">\r\n                        <Input v-model=\"form.config.remark\" type=\"textarea\" :autosize=\"{minRows: 2,maxRows: 5}\"/>\r\n                    </FormItem>\r\n                    <FormItem :label-width=\"80\">\r\n                        <Button type=\"primary\" style=\"margin-left: 30px\" @click=\"handleSubmit('formConfig')\">提交</Button>\r\n                        <Button style=\"margin-left: 8px\" @click=\"handleReset('formConfig')\">重置</Button>\r\n                    </FormItem>\r\n                </Form>\r\n            </Drawer>\r\n\r\n        </Card>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import {post} from \"../../../libs/axios-cfg\";\r\n\r\n    export default {\r\n        name: \"index\",\r\n        data() {\r\n            return {\r\n                options: {\r\n                    status: [\r\n                        {value: \"Y\", label: \"生效\"},\r\n                        {value: \"N\", label: \"失效\"}\r\n                    ],\r\n                    configCls: [\r\n                        {value: \"CONSTANTS\", label: \"系统常量配置\"},\r\n                        {value: \"MILLET_COMMON\", label: \"小米充值配置普通\"},\r\n                        {value: \"MILLET_PRIMARY\", label: \"小米充值配置会员\"},\r\n                        {value: \"MILLET_SENIOR\", label: \"小米充值配置高级\"},\r\n                        {value: \"MILLET_SUPERSTAR\", label: \"小米充值配置超级\"},\r\n                        {value: \"COUNTRY_LIST\", label: \"国家配置\"}\r\n                    ]\r\n                },\r\n                search: {\r\n                    status: null,\r\n                    configCls: null,\r\n                    variable: null,\r\n                    page: 1,\r\n                    pageSize: 10\r\n                },\r\n                content: {\r\n                    loading: false,\r\n                    total: 0,\r\n                    records: [],\r\n                    columns: [\r\n                        {\r\n                            title: '配置ID',\r\n                            key: 'id',\r\n                            width: 100\r\n                        },\r\n                        {\r\n                            title: '配置参数',\r\n                            key: 'variable',\r\n                            width: 250\r\n                        },\r\n                        {\r\n                            title: '配置值',\r\n                            key: 'value',\r\n                            width: 500\r\n                        },\r\n                        {\r\n                            title: '配置分类',\r\n                            key: 'configCls',\r\n                            width: 150,\r\n                            render: (h, params) => {\r\n                                return h('span', {}, params.row.configCls && params.row.configCls.name);\r\n                            }\r\n                        },\r\n                        {\r\n                            title: '扩展值',\r\n                            key: 'extendValue',\r\n                            width: 200\r\n                        },\r\n                        {\r\n                            title: '是否生效',\r\n                            key: 'status',\r\n                            width: 100,\r\n                            render: (h, params) => {\r\n                                return h('span', {}, params.row.status && params.row.status.name);\r\n                            }\r\n                        },\r\n                        {\r\n                            title: '备注',\r\n                            key: 'remark',\r\n                            width: 200\r\n                        },\r\n                        {\r\n                            title: '操作',\r\n                            key: 'action',\r\n                            width: 150,\r\n                            fixed: 'right',\r\n                            align: 'center',\r\n                            render: (h, params) => {\r\n                                return h('div', [\r\n                                    h('Button', {\r\n                                        props: {\r\n                                            type: 'primary',\r\n                                            size: 'small'\r\n                                        },\r\n                                        style: {\r\n                                            marginRight: '5px'\r\n                                        },\r\n                                        on: {\r\n                                            click: () => {\r\n                                                this.handleEdit(params.row)\r\n                                            }\r\n                                        }\r\n                                    }, '编辑')\r\n                                ])\r\n                            }\r\n                        }\r\n                    ]\r\n                },\r\n                form: {\r\n                    title: \"新增配置项\",\r\n                    isAdd: true,\r\n                    show: false,\r\n                    config: {},\r\n                    ruleValidate: {\r\n                        variable: [\r\n                            {required: true, message: '配置参数不能为空', trigger: 'blur'}\r\n                        ],\r\n                        value: [\r\n                            {required: true, message: '配置值不能为空', trigger: 'blur'}\r\n                        ],\r\n                        status: [\r\n                            {required: true, message: '状态不能为空', trigger: 'change'}\r\n                        ]\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        created() {\r\n            this.queryConfig();\r\n        },\r\n        methods: {\r\n            handleSearch() {\r\n                this.queryConfig();\r\n            },\r\n            handleEdit(row) {\r\n                this.form.title = \"修改配置项\";\r\n                this.form.isAdd = false;\r\n                this.form.config = JSON.parse(JSON.stringify(row));\r\n                if (this.form.config.status) {\r\n                    this.form.config.status = this.form.config.status.value;\r\n                }\r\n                if (this.form.config.configCls) {\r\n                    this.form.config.configCls = this.form.config.configCls.value;\r\n                }\r\n                this.form.show = true;\r\n            },\r\n            handleCreate() {\r\n                this.form.title = \"新增配置项\";\r\n                this.form.isAdd = true;\r\n                this.form.config = {};\r\n                this.form.show = true;\r\n            },\r\n            handleChangePage(page) {\r\n                this.search.page = page;\r\n                this.queryConfig();\r\n            },\r\n            handleChangePageSize(pageSize) {\r\n                this.search.pageSize = pageSize;\r\n                this.queryConfig();\r\n            },\r\n            handleSubmit(name) {\r\n                var self = this;\r\n                this.$refs[name].validate((valid) => {\r\n                    if (valid) {\r\n                        if (self.form.isAdd) {\r\n                            this.createConfig();\r\n                        } else {\r\n                            this.updateConfig();\r\n                        }\r\n                        this.form.show = false;\r\n                        setTimeout(this.queryConfig, 1000);\r\n                    } else {\r\n                        this.$Message.error('验证不通过!')\r\n                    }\r\n                })\r\n            },\r\n            handleReset(name) {\r\n                this.$refs[name].resetFields();\r\n            },\r\n            async queryConfig() {\r\n                this.content.loading = true;\r\n                try {\r\n                    let res = await post(\"/system/config/list\", this.search);\r\n                    if (res.status == this.rescode.OK) {\r\n                        this.content.records = res.data.records;\r\n                        this.content.total = res.data.total;\r\n                    } else {\r\n                        this.$Message.error(res.msg);\r\n                    }\r\n                } catch (e) {\r\n                    this.$throw(e);\r\n                }\r\n                this.content.loading = false;\r\n            },\r\n            async createConfig() {\r\n                try {\r\n                    let res = await post(\"/system/config/add\", this.form.config);\r\n                    if (res.status = this.rescode.OK) {\r\n                        this.$Message.success(\"新增成功\");\r\n                    } else {\r\n                        this.$Message.error(res.msg);\r\n                    }\r\n                } catch (e) {\r\n                    this.$throw(e);\r\n                }\r\n            },\r\n            async updateConfig() {\r\n                try {\r\n                    let res = await post(\"/system/config/update/\" + this.form.config.id, this.form.config);\r\n                    if (res.status = this.rescode.OK) {\r\n                        this.$Message.success(\"更新成功\");\r\n                    } else {\r\n                        this.$Message.error(res.msg);\r\n                    }\r\n                } catch (e) {\r\n                    this.$throw(e);\r\n                }\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"]}]}